# iReverb

## Table of Contents

- [About](#about)
- [Getting Started](#getting_started)
- [Installation](#installation)
- [Background](#background)

## About <a name = "about"></a>

Machine Learning detection and identification of OBS signal features, with a focus on detecting and mapping current-induced OBS resonances and blue whale vocalisations.

This is the official implementation of the paper:

*Feature detection in Ocean Bottom Seismometer data with semantic segmentation*, Saoulis et al. 2025

## Getting Started <a name = "getting_started"></a>

We provide some open data examples in [`examples`](./examples/) using the publically available RHUM-RUM data. This includes the whale tracking example from the paper, reproducing the Antarctic Blue Whale track from [Dreo et al. 2019](https://hal.science/hal-01780315/file/Dreo_whale_detection_RHUM-RUM_DSR_2019_hal.pdf), as well as a simple example for extracting the instrument resonance energy from RHUM-RUM data. 

The source code for data annotation, model training, and inference can be found in [`src/reverb`](./src/reverb). For the synthetic data generation code, see [`src/reverb/training/synthetic_resonances.py`](./src/reverb/training/synthetic_resonances.py). 

Various utilities for data annotation, model training, and processing the model results are provided throughout [`segmentation`](./segmentation/). 

 * For the model training and hyper-parameter exploration, see [`segmentation/model_training`](./segmentation/model_training). This has examples for training the supervised, semi-supervised, and synthetic pre-training models for both resonances and whales, along with the associated training configurations. 
  * For examples of processing the UPFLOW data and analysing the ML model outputs, see [`segmentation/analysis`](./segmentation/analysis). This contains a script for estimating the resonant energies ([`station_energies.py`](./segmentation/analysis/station_energies.py)), as well as a notebooks for processing the resonant energies and whale call detections. 



## Installation <a name = "installation"></a>


Required libraries:

- Conda
- git-lfs
- Python 3.9
- (optional) NVIDIA CUDA drivers (compatible with >= torch 2.0)

Install Anaconda or Miniconda. You will also need to install git-lfs (git large file system, a simple git add on for larger files) in order to download the model checkpoint files. Set up your conda environment by executing the following command in the terminal, assuming `my_env` is the name of your conda environment:

```
conda create -n "my_env" python=3.9
conda activate my_env
conda install -c conda-forge git-lfs -y
git lfs install
git clone git@github.com:upflow-eu/reverb.git
cd reverb
git lfs fetch --all
git lfs pull
```

### Installing

Installation of the library can then be done by navigating to the `reverb` directory and running:
```
pip install -e .
```

Once pip has installed the relevant libraries, you should be good to go!

### Examples

See [examples/rum_rhum.ipynb](examples/rum_rhum.ipynb) for a end-to-end demo for downloading OBS data, processing it, using a trained ML model to label the resonances, and some simple results plotting. 

## Background <a name = "background"></a>

OBS sensors are exposed to various oceanic physical phenomena that can affect the quality of seismic recordings. These phenomena introduce unwanted signals into the recordings, either by affecting the coupling between the instrument and the seafloor or by introducing unrelated energy sources that interfere with the seismic signals.

Long-lasting harmonic noise in OBS is characterized by narrow and energetic peaks occurring at frequencies of a few Hz. This noise is primarily attributed to lift and drag effects caused by the von Kármán vortex shedding from different parts of the OBS instrument. These vortex shedding phenomena create oscillatory disturbances that contribute to the observed harmonic noise, affecting the overall quality of the recordings.

In certain cases, the observed frequency of the harmonic noise remains consistent regardless of the velocity of the ocean currents. However, the amplitudes and the number of distinguishable overtones present in the noise are influenced by the strength of permanent oceanic currents, which are further reinforced by tidal currents.

Here, we investigate the effects of tidal currents, aiming to highlight the differences in the noise levels generated by these tidal conditions across the various instrument types.
 
